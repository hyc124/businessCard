(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myCenter/edit/edit","components/card/card"],{1758:function(t,e,n){},"1f3e":function(t,e,n){"use strict";var o=n("1758"),r=n.n(o);r.a},"2f0f":function(t,e,n){"use strict";var o=n("2f85"),r=n.n(o);r.a},"2f85":function(t,e,n){},"3c02":function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var o={uNavbar:function(){return n.e("uview-ui/components/u-navbar/u-navbar").then(n.bind(null,"4585"))},uAvatar:function(){return n.e("uview-ui/components/u-avatar/u-avatar").then(n.bind(null,"9a4c"))},card:function(){return Promise.resolve().then(n.bind(null,"e55a"))},uForm:function(){return n.e("uview-ui/components/u-form/u-form").then(n.bind(null,"098e"))},uFormItem:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-form-item/u-form-item")]).then(n.bind(null,"4561"))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-input/u-input")]).then(n.bind(null,"61b2"))},uButton:function(){return n.e("uview-ui/components/u-button/u-button").then(n.bind(null,"1fd2"))},choice:function(){return n.e("components/choice/choice").then(n.bind(null,"9274"))},uTopTips:function(){return n.e("uview-ui/components/u-top-tips/u-top-tips").then(n.bind(null,"95f1"))}},r=function(){var t=this,e=t.$createElement;t._self._c},i=[]},"55dd":function(t,e,n){"use strict";n.r(e);var o=n("9ce4"),r=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=r.a},7004:function(t,e,n){"use strict";(function(t){n("4ee8");o(n("66fd"));var e=o(n("aeb3"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"8d57":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={props:["info","isMyCard","auth","navHeight","onOff"],data:function(){return{showInfo:!1,cardInfo:{username:"",position:"",company:"",company_address:"",telephone:"",fax:"",mobile:"",post:"",email:"",zip_code:"",company_name:"",qy_code:"",main_department:""},loading:!0,bgColor:"#fffff",elColor:"#71B747"}},computed:{imgSrc:function(){return"../../static/svg/bigimg".concat(this.cardInfo.style||2,".svg")},longImgSrc:function(){return"../../static/svg/longimg".concat(this.cardInfo.style||2,".svg")}},watch:{info:{handler:function(t){this.loading=!1,this.cardInfo=t},immediate:!0,deep:!0}},methods:{toQrcode:function(e){t.navigateTo({url:"../../pages/qycode/qycode"}),this.showInfo=!1},handlerShowCard:function(e){1!=this.onOff&&2!=this.onOff?this.isMyCard?t.navigateTo({url:"/pages/card/card"}):this.showInfo=!0:2==this.onOff&&this.$emit("onSeeCard",e.id)}}};e.default=n}).call(this,n("543d")["default"])},"9ce4":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n("a34a")),r=(i(n("e55a")),i(n("da82")));function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e,n,o,r,i,a){try{var u=t[i](a),s=u.value}catch(c){return void n(c)}u.done?e(s):Promise.resolve(s).then(o,r)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var i=t.apply(e,n);function u(t){a(i,o,r,u,s,"next",t)}function s(t){a(i,o,r,u,s,"throw",t)}u(void 0)}))}}var s=function(){n.e("components/choice/choice").then(function(){return resolve(n("9274"))}.bind(null,n)).catch(n.oe)},c={data:function(){var t=this;return{form:{avatar:"",username:"",mobile:"",company_name:"",company_name_en:"",position:"",main_department:"",email:"",zip_code:"",company_address:"",telephone:"",fax:"",wx_num:"",qq_num:"",intro:"",type:"2",id:"",introduce:"",status:1,style:1,group_id:"",is_default_group:0},rules:{username:[{required:!0,message:"请输入姓名",trigger:["blur"]}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:function(e,n,o){return t.$u.test.mobile(n)},message:"请输入正确手机号",trigger:["change","blur"]}],company_name:[{required:!0,message:"请输入公司名称",trigger:"blur"}],main_department:[{required:!0,message:"请输入部门",trigger:"blur"}],position:[{required:!0,message:"请输入职务",trigger:"blur"}],email:[{type:"email",message:"请输入正确邮箱地址",trigger:"change"}],zip_code:[{type:"number",message:"请输入正确邮编",trigger:["change","blur"]}],wx_num:[{message:"微信号为6-32位",trigger:["change","blur"],min:6,max:32}],qq_num:[{type:"number",message:"QQ号为6-32位",trigger:["change","blur"],min:6,max:32}]},loading:"",title:"编辑名片",avatar:"",originData:{},isNew:0,share:"",options:{type:"",id:"",state:""},backNum:2,show:{onOff:!1},onshow:!1}},watch:{cardInfo:{handler:function(t){var e=this;this.loading=!1,this.originData=this.cardInfo,Object.keys(this.form).forEach((function(n){void 0!=t[n]&&(e.form[n]=t[n])}))},deep:!0}},components:{choice:s},onLoad:function(t){this.options={type:t.type,state:t.state,id:t.id,onOff:t.onOff},this.form.type=t.type,0==t.state?(this.getInfo(),2==t.type&&(this.title="创建名片")):(2==this.options.type?(this.title="创建名片",1==t.add&&this.handleForm()):this.getUserInfo(this.options.id),this.loading=!1)},computed:{cardInfo:function(){return this.$store.state.cardInfo},getInfos:function(){return this.$store.state.info}},methods:{onChoice:function(t){var e=this;if(2==t.num){for(var n in t.data)this.form[n]=t.data[n];this.submit()}this.show.onOff=!1,setTimeout((function(){e.onshow=!1}),300)},onGenerateSuccess:function(e){var n=t.baseUrl;t.uploadFile({url:n+"/vcard/upload",filePath:e.detail.path,name:"img",header:{token:t.getStorageSync("token")},formData:{id:this.cardInfo.id,type:2},success:function(t){console.log(t)},fail:function(){t.hideLoading(),that.showMsg("error","上传失败")}})},onSetBackNum:function(t){this.backNum=t,this.form.style=t,""!=this.options.id&&void 0!=this.options.id&&this.getVcardStyle(t)},onGenerateError:function(t){console.log(t)},save:function(){var t=this;this.$refs.uForm.validate((function(e){e&&(""==t.form.group_id&&1==t.options.state?0!=t.cardInfo.default_group_id?t.form.group_id=t.cardInfo.default_group_id:(t.show.onOff=!0,t.onshow=!0):t.submit())}))},handleForm:function(){for(var t in this.getInfos)this.form[t]=this.getInfos[t]},getVcardStyle:function(){var t=arguments,e=this;return u(o.default.mark((function n(){var r,i,a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.length>0&&void 0!==t[0]?t[0]:1,n.next=3,e.$u.api.vcardStyle({id:e.form.id,style:r});case 3:i=n.sent,i.data,a=i.code,1==a&&console.log("改变背景成功");case 7:case"end":return n.stop()}}),n)})))()},getUserInfo:function(t){var e=this;return u(o.default.mark((function n(){var r,i;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$u.api.cardInfo({id:t});case 2:r=n.sent,i=r.data,e.originData=i,i.type=e.options.type,e.backNum=i.style,Object.keys(e.form).forEach((function(t){void 0!=i[t]&&(e.form[t]=i[t])}));case 8:case"end":return n.stop()}}),n)})))()},submit:function(){var e=this;return u(o.default.mark((function n(){var i,a,u,s,c;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.loading=!0,e.form.status=1,e.form.is_customer=e.options.state,n.prev=3,n.next=6,e.$u.api.creadCard(e.form);case 6:if(i=n.sent,a=i.code,u=i.data,s=i.msg,e.loading=!1,1==a){for(c in e.form)e.form[c]="";e.$refs.uTips.show({title:s,type:"success",duration:"1000"}),0==e.options.state?(e.share=new r.default(e.cardInfo).palette(),e.$store.commit("SetIsCreat",!0),e.getInfo(1)):(e.getInfo(),e.$store.commit("SetCustomerId",""),t.navigateTo({url:"/pages/successfully/successfully?id=4&id=".concat(u)}))}else 2==a?(e.$refs.uTips.show({title:s,type:"error",duration:"1000"}),setTimeout((function(){t.navigateTo({url:"/pages/card/card"})}),1e3)):e.$refs.uTips.show({title:s,type:"error",duration:"1000"});n.next=18;break;case 14:n.prev=14,n.t0=n["catch"](3),e.loading=!1,e.$refs.uTips.show({title:"创建失败",type:"error",duration:"1000"});case 18:case"end":return n.stop()}}),n,null,[[3,14]])})))()},getInfo:function(e){var n=this;return u(o.default.mark((function r(){var i,a;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,n.$u.api.cardInfo();case 2:i=o.sent,a=i.data,void 0!=a&&(a.type=n.options.type,n.backNum=a.style,n.$store.commit("SetCardInfo",a),1==e&&t.switchTab({url:"/pages/card/card"}));case 5:case"end":return o.stop()}}),r)})))()},handleMycenter:function(){t.redirectTo({url:"/pages/myCenter/index/index"})}},onReady:function(){this.$refs.uForm.setRules(this.rules)}};e.default=c}).call(this,n("543d")["default"])},aeb3:function(t,e,n){"use strict";n.r(e);var o=n("3c02"),r=n("55dd");for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);n("1f3e");var a,u=n("f0c5"),s=Object(u["a"])(r["default"],o["b"],o["c"],!1,null,"302c096d",null,!1,o["a"],a);e["default"]=s.exports},b475:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var o={uPopup:function(){return n.e("uview-ui/components/u-popup/u-popup").then(n.bind(null,"2200"))},uSkeleton:function(){return n.e("uview-ui/components/u-skeleton/u-skeleton").then(n.bind(null,"4fdf"))}},r=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.showInfo=!1})},i=[]},e55a:function(t,e,n){"use strict";n.r(e);var o=n("b475"),r=n("ea9d");for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);n("2f0f");var a,u=n("f0c5"),s=Object(u["a"])(r["default"],o["b"],o["c"],!1,null,"1d149615",null,!1,o["a"],a);e["default"]=s.exports},ea9d:function(t,e,n){"use strict";n.r(e);var o=n("8d57"),r=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=r.a}},[["7004","common/runtime","common/vendor"]]]);